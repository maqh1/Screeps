{"version":3,"file":"main.js","sources":["../src/config.js","../src/role/harvester.js","../src/role/builder.js","../src/role/upgrader.js","../src/method.js","../src/main.js"],"sourcesContent":["const config = {\r\n    maxHarvesters: 5,\r\n    maxBuilders: 3,\r\n    maxUpgraders: 5,\r\n    spawnName: `maqh`\r\n};\r\n\r\nexport {config};","var roleHarvester = {\r\n    run: function(creep, spawn_name) {\r\n        // 如果Creep有空余容量\r\n        if(creep.store.getFreeCapacity() > 0) {\r\n            // 找到最近的能量源\r\n            var source = creep.pos.findClosestByPath(FIND_SOURCES_ACTIVE);\r\n            if(source) {\r\n                // 尝试收集资源，如果不在范围内则移动到该资源点\r\n                if(creep.harvest(source) == ERR_NOT_IN_RANGE) {\r\n                    creep.moveTo(source, {visualizePathStyle: {stroke: '#ffaa00'}});\r\n                }\r\n            }\r\n        } else {\r\n            // 如果Creep满载能量\r\n            var spawn = Game.spawns[spawn_name];\r\n            if(spawn) {\r\n                // 尝试将能量传输到Spawn，如果不在范围内则移动到Spawn\r\n                if(creep.transfer(spawn, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n                    creep.moveTo(spawn, {visualizePathStyle: {stroke: '#ffffff'}});\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nexport { roleHarvester };","var roleBuilder = {\r\n    run: function(creep) {\r\n        // 如果Creep在建造并且能量耗尽，则切换到收集模式\r\n        if(creep.memory.building && creep.store[RESOURCE_ENERGY] == 0) {\r\n            creep.memory.building = false;\r\n            creep.say('🔄 harvest');\r\n        }\r\n        // 如果Creep不在建造并且能量已满，则切换到建造模式\r\n        if(!creep.memory.building && creep.store[RESOURCE_ENERGY] == creep.store.getCapacity()) {\r\n            creep.memory.building = true;\r\n            creep.say('🚧 build');\r\n        }\r\n        // 如果Creep在建造模式\r\n        if(creep.memory.building) {\r\n            // 找到最近的工地\r\n            var target = creep.pos.findClosestByPath(FIND_CONSTRUCTION_SITES);\r\n            if(target) {\r\n                // 尝试建造，如果不在范围内则移动到该工地\r\n                if(creep.build(target) == ERR_NOT_IN_RANGE) {\r\n                    creep.moveTo(target, {visualizePathStyle: {stroke: '#ffffff'}});\r\n                }\r\n            }\r\n        }\r\n        // 否则，进入收集模式\r\n        else {\r\n            // 找到最近的能量点\r\n            var source = creep.pos.findClosestByPath(FIND_SOURCES);\r\n            if(source) {\r\n                // 尝试收集资源，如果不在范围内则移动到该资源点\r\n                if(creep.harvest(source) == ERR_NOT_IN_RANGE) {\r\n                    creep.moveTo(source, {visualizePathStyle: {stroke: '#ffaa00'}});\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nexport { roleBuilder };","var roleUpgrader = {\r\n    /** @param {Creep} creep **/\r\n    run: function(creep) {\r\n\r\n        // 如果Creep在升级并且能量耗尽，则切换到采集模式\r\n        if(creep.memory.upgrading && creep.store[RESOURCE_ENERGY] == 0) {  \r\n            creep.memory.upgrading = false; \r\n            creep.say('🔄 harvest');\r\n\t    }\r\n        // 如果Creep不在升级并且能量已满，则切换到升级模式\r\n\t    if(!creep.memory.upgrading && creep.store.getFreeCapacity() == 0) {  \r\n\t        creep.memory.upgrading = true;\r\n\t        creep.say('⚡ upgrade');\r\n\t    }\r\n\r\n        // 如果Creep在升级模式\r\n\t    if(creep.memory.upgrading) { \r\n            // 尝试升级控制器，如果不在范围内则移动到控制器\r\n            if(creep.upgradeController(creep.room.controller) == ERR_NOT_IN_RANGE) {\r\n                creep.moveTo(creep.room.controller, {visualizePathStyle: {stroke: '#ffffff'}});\r\n            }\r\n        } else {  // 否则进入采集模式\r\n            // 找到最近的能量源\r\n            var source = creep.pos.findClosestByPath(FIND_SOURCES_ACTIVE);\r\n            if(source) {\r\n                // 尝试收集资源，如果不在范围内则移动到该资源点\r\n                if(creep.harvest(source) == ERR_NOT_IN_RANGE) {\r\n                    creep.moveTo(source, {visualizePathStyle: {stroke: '#ffaa00'}});\r\n                }\r\n            }\r\n        }\r\n\t}\r\n};\r\n\r\nexport { roleUpgrader };","import { config } from './config';\r\nimport { roleHarvester } from './role/harvester';\r\nimport { roleBuilder } from './role/builder';\r\nimport { roleUpgrader } from './role/upgrader';\r\n\r\nvar Method = {\r\n    create: function (name, fn, body) {\r\n        var newName = name + Game.time;\r\n        Game.spawns[config.spawnName].spawnCreep(body, newName, { memory: { role: fn } });\r\n    },\r\n    check_and_create: function () {\r\n        var harvesters = _.filter(Game.creeps, (creep) => creep.memory.role == 'harvester');\r\n        var builders = _.filter(Game.creeps, (creep) => creep.memory.role == 'builder');\r\n        var upgraders = _.filter(Game.creeps, (creep) => creep.memory.role == 'upgrader');\r\n        var energyAvailable = Game.spawns[config.spawnName].room.energyAvailable;\r\n        if (harvesters.length < config.maxHarvesters && energyAvailable >= 200) {\r\n            Method.create('Harvester', 'harvester', [WORK, CARRY, MOVE]);\r\n        } else if (builders.length < config.maxBuilders && energyAvailable >= 200) {\r\n            Method.create('Builder', 'builder', [WORK, CARRY, MOVE]);\r\n        } else if (upgraders.length < config.maxUpgraders && energyAvailable >= 200) {\r\n            Method.create('Upgrader', 'upgrader', [WORK, CARRY, MOVE]);\r\n        }\r\n    },\r\n    remove_dead: function () {\r\n        for (var name in Memory.creeps) {\r\n            if (!Game.creeps[name]) {\r\n                delete Memory.creeps[name];\r\n            }\r\n        }\r\n    },\r\n    run: function () {\r\n        for (var name in Game.creeps) {\r\n            var creep = Game.creeps[name];\r\n            if (creep.memory.role == 'harvester') {\r\n                roleHarvester.run(creep, config.spawnName);\r\n            }\r\n            if (creep.memory.role == 'builder') {\r\n                roleBuilder.run(creep);\r\n            }\r\n            if (creep.memory.role == 'upgrader') {\r\n                roleUpgrader.run(creep);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport { Method };","import { Method } from './method';\r\n\r\nexport const loop  = function () {\r\n    Method.remove_dead();\r\n    Method.check_and_create();\r\n    Method.run();\r\n}\r\n"],"names":[],"mappings":"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"}